# æ•¸æ“šè¦–è¦ºåŒ–åŠŸèƒ½è¨­è¨ˆ

> å»ºç«‹æ—¥æœŸï¼š2026-01-21

## åŠŸèƒ½æ¦‚è¿°

æœ¬æ¬¡æ–°å¢å…©å€‹æ•¸æ“šè¦–è¦ºåŒ–åŠŸèƒ½ï¼š

1. **é€²æ­¥è¶¨å‹¢åœ– (Progress Trend Chart)**
   - ä½ç½®ï¼šé‹å‹•é …ç›®è©³æƒ…é çš„ç¨ç«‹åœ–è¡¨é é¢
   - åŠŸèƒ½ï¼šé¡¯ç¤ºè©²å‹•ä½œåœ¨è‡ªè¨‚æ™‚é–“ç¯„åœå…§çš„é€²æ­¥æ›²ç·š
   - å¯åˆ‡æ›æŒ‡æ¨™ï¼šæœ€å¤§é‡é‡ / è¨“ç·´é‡ / ä¼°ç®— 1RM

2. **è¨“ç·´åˆ†ä½ˆé›·é”åœ– (Training Distribution Radar)**
   - ä½ç½®ï¼šé¦–é åº•éƒ¨çµ±è¨ˆå€
   - åŠŸèƒ½ï¼šé¡¯ç¤ºè¿‘ 4 é€±å„èº«é«”éƒ¨ä½çš„è¨“ç·´å¤©æ•¸åˆ†ä½ˆ

## å¥—ä»¶è®Šæ›´

```diff
# ç§»é™¤
- "react-native-chart-kit": "^6.12.0"

# æ–°å¢
+ "react-native-gifted-charts": "^1.4.x"
+ "@react-native-community/datetimepicker": "^8.x"
```

## è³‡æ–™å±¤è¨­è¨ˆ

### useProgressTrend.ts

```typescript
interface ProgressDataPoint {
  date: string; // YYYY-MM-DD
  maxWeight: number; // ç•¶æ—¥æœ€å¤§é‡é‡
  volume: number; // ç•¶æ—¥è¨“ç·´é‡ (weight Ã— reps Ã— sets)
  estimated1RM: number; // ä¼°ç®—æœ€å¤§é‡é‡
}

interface UseProgressTrendParams {
  exerciseId: number;
  startDate: string;
  endDate: string;
}

interface UseProgressTrendResult {
  data: ProgressDataPoint[];
  isLoading: boolean;
  error: Error | null;
}
```

è³‡æ–™ä¾†æºï¼šæŸ¥è©¢ `workout_sessions` + `workout_sets` è¡¨ï¼Œä¾æ—¥æœŸèšåˆè¨ˆç®—å„æŒ‡æ¨™ã€‚

### useBodyPartDistribution.ts

```typescript
interface BodyPartStat {
  bodyPart: string; // èº«é«”éƒ¨ä½åç¨±
  trainingDays: number; // è¨“ç·´å¤©æ•¸
}
```

è³‡æ–™ä¾†æºï¼š`workout_sessions` JOIN `exercises` JOIN `exercise_body_parts`ï¼Œè¨ˆç®—è¿‘ 4 é€±å„èº«é«”éƒ¨ä½çš„è¨“ç·´å¤©æ•¸ã€‚

### ä¼°ç®— 1RM å…¬å¼

ä½¿ç”¨ Epley å…¬å¼ï¼š

```
1RM = weight Ã— (1 + reps / 30)
```

## UI å…ƒä»¶è¨­è¨ˆ

### ProgressTrendChart.tsx

ä½ç½®ï¼š`src/components/charts/ProgressTrendChart.tsx`

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“ˆ é€²æ­¥è¶¨å‹¢                    [æŒ‡æ¨™ â–¼] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                          â—      â”‚    â”‚
â”‚  â”‚                    â—            â”‚    â”‚
â”‚  â”‚              â—                  â”‚    â”‚
â”‚  â”‚        â—                        â”‚    â”‚
â”‚  â”‚  â—                              â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚  [2024/01/01] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ [2024/03/01]  â”‚
â”‚        â†‘ å¯é»æ“Šé¸æ“‡æ—¥æœŸç¯„åœ               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

Propsï¼š

- `exerciseId: number`
- `exerciseName: string`

å…§éƒ¨ç‹€æ…‹ï¼š

- `metric`: 'maxWeight' | 'volume' | 'estimated1RM'
- `startDate` / `endDate`: æ—¥æœŸé¸æ“‡å™¨ç‹€æ…‹

### BodyPartRadar.tsx

ä½ç½®ï¼š`src/components/charts/BodyPartRadar.tsx`

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ¯ è¨“ç·´åˆ†ä½ˆï¼ˆè¿‘ 4 é€±ï¼‰                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚           èƒ¸                            â”‚
â”‚            â•±â•²                           â”‚
â”‚       è‚© â•±    â•² èƒŒ                      â”‚
â”‚         â•±  â–ˆâ–ˆ  â•²                        â”‚
â”‚        â•±        â•²                       â”‚
â”‚    æ‰‹è‡‚ â”€â”€â”€â”€â”€â”€â”€â”€ æ ¸å¿ƒ                    â”‚
â”‚          â•²    â•±                         â”‚
â”‚           â•²â•±                            â”‚
â”‚           è…¿                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

Propsï¼šç„¡ï¼ˆå…§éƒ¨ç›´æ¥å‘¼å« hook å–å¾—è³‡æ–™ï¼‰

UI é¢¨æ ¼ï¼šå¡ç‰‡å¼æ˜äº®é¢¨æ ¼ï¼Œèˆ‡æ·±è‰²èƒŒæ™¯å½¢æˆå°æ¯”ã€‚

## é é¢æ•´åˆ

### é€²æ­¥è¶¨å‹¢åœ–é é¢

è·¯ç”±çµæ§‹ï¼š

```
app/
â”œâ”€â”€ exercise/
â”‚   â”œâ”€â”€ [id].tsx          # ç·¨è¼¯é ï¼ˆåŠ å…¥åœ–è¡¨æŒ‰éˆ•ï¼‰
â”‚   â””â”€â”€ [id]/
â”‚       â””â”€â”€ chart.tsx     # æ–°å¢ï¼šè¶¨å‹¢åœ–é é¢
```

é‹å‹•é …ç›®ç·¨è¼¯é  Headerï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â† è¿”å›    æ·±è¹²        [ğŸ“Š åœ–è¡¨] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

è¶¨å‹¢åœ–é é¢ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â† è¿”å›    æ·±è¹² - é€²æ­¥è¶¨å‹¢       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [æŒ‡æ¨™ â–¼] æœ€å¤§é‡é‡              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚      ğŸ“ˆ æŠ˜ç·šåœ–å€åŸŸ              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [2024/01/01] â”€â”€ [2024/03/01]  â”‚
â”‚       æ—¥æœŸç¯„åœé¸æ“‡å™¨            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### é¦–é é›·é”åœ–

åœ¨ç¾æœ‰çš„ `StatsCard` å€å¡Šä¸‹æ–¹æ–°å¢ `BodyPartRadar` å…ƒä»¶ã€‚

## æ—¥æœŸé¸æ“‡å™¨

ä½¿ç”¨ `@react-native-community/datetimepicker`ï¼ˆReact Native å®˜æ–¹æ¨è–¦ï¼‰ã€‚

é è¨­æ—¥æœŸç¯„åœï¼š

- çµæŸæ—¥æœŸï¼šä»Šå¤©
- é–‹å§‹æ—¥æœŸï¼š3 å€‹æœˆå‰ï¼ˆæˆ–è©²å‹•ä½œçš„ç¬¬ä¸€ç­†ç´€éŒ„æ—¥æœŸï¼Œå–è¼ƒæ™šè€…ï¼‰

## éŒ¯èª¤è™•ç†

| æƒ…å¢ƒ                 | è™•ç†æ–¹å¼                                 |
| -------------------- | ---------------------------------------- |
| è©²å‹•ä½œç„¡ä»»ä½•ç´€éŒ„     | é¡¯ç¤ºç©ºç‹€æ…‹ï¼šã€Œé‚„æ²’æœ‰ç´€éŒ„ï¼Œé–‹å§‹è¨“ç·´å§ï¼ã€ |
| é¸æ“‡çš„æ—¥æœŸç¯„åœç„¡è³‡æ–™ | é¡¯ç¤ºæç¤ºï¼šã€Œæ­¤æœŸé–“æ²’æœ‰ç´€éŒ„ã€             |
| è³‡æ–™è¼‰å…¥ä¸­           | é¡¯ç¤ºéª¨æ¶å±æˆ– Loading æŒ‡ç¤ºå™¨              |
| è³‡æ–™åº«æŸ¥è©¢å¤±æ•—       | é¡¯ç¤ºéŒ¯èª¤è¨Šæ¯ï¼Œæä¾›é‡è©¦æŒ‰éˆ•               |
| é–‹å§‹æ—¥æœŸ > çµæŸæ—¥æœŸ  | è‡ªå‹•äº¤æ›æ—¥æœŸæˆ–é¡¯ç¤ºæç¤º                   |

## æª”æ¡ˆæ¸…å–®

| æª”æ¡ˆ                                           | å‹•ä½œ | èªªæ˜                |
| ---------------------------------------------- | ---- | ------------------- |
| `src/hooks/useProgressTrend.ts`                | æ–°å¢ | é€²æ­¥è¶¨å‹¢è³‡æ–™ hook   |
| `src/hooks/useBodyPartDistribution.ts`         | æ–°å¢ | èº«é«”éƒ¨ä½åˆ†ä½ˆ hook   |
| `src/components/charts/ProgressTrendChart.tsx` | æ–°å¢ | é€²æ­¥è¶¨å‹¢åœ–å…ƒä»¶      |
| `src/components/charts/BodyPartRadar.tsx`      | æ–°å¢ | é›·é”åœ–å…ƒä»¶          |
| `src/components/charts/ProgressChart.tsx`      | åˆªé™¤ | ç§»é™¤èˆŠåœ–è¡¨å…ƒä»¶      |
| `app/exercise/[id].tsx`                        | ä¿®æ”¹ | Header åŠ å…¥åœ–è¡¨æŒ‰éˆ• |
| `app/exercise/[id]/chart.tsx`                  | æ–°å¢ | è¶¨å‹¢åœ–ç¨ç«‹é é¢      |
| `app/(tabs)/index.tsx`                         | ä¿®æ”¹ | é¦–é åŠ å…¥é›·é”åœ–      |

## å¯¦ä½œé †åº

1. **ç’°å¢ƒæº–å‚™**
   - ç§»é™¤ `react-native-chart-kit`
   - å®‰è£ `react-native-gifted-charts` å’Œ `datetimepicker`

2. **è³‡æ–™å±¤**
   - å¯¦ä½œ `useProgressTrend` hook
   - å¯¦ä½œ `useBodyPartDistribution` hook

3. **é€²æ­¥è¶¨å‹¢åœ–**
   - å»ºç«‹ `ProgressTrendChart` å…ƒä»¶
   - å»ºç«‹ `app/exercise/[id]/chart.tsx` é é¢
   - ä¿®æ”¹ `app/exercise/[id].tsx` åŠ å…¥åœ–è¡¨æŒ‰éˆ•

4. **è¨“ç·´åˆ†ä½ˆé›·é”åœ–**
   - å»ºç«‹ `BodyPartRadar` å…ƒä»¶
   - æ•´åˆåˆ°é¦–é 

5. **æ¸¬è©¦èˆ‡å„ªåŒ–**
   - é©—è­‰å„ç¨®é‚Šç•Œæƒ…æ³
   - UI ç´°ç¯€èª¿æ•´
